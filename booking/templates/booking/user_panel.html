{% extends 'base.html' %}
{% load static %}
{% block content %}
  <main id="user-bookings">
    <section id="user-details">
      <h2 id="info-title">Your Info:</h2>
      <div id="details-list">
        <ul id="user-info">
          <li class="list-group mt-2">First Name: {{ user.first_name }}</li>
          <li class="list-group mt-2">Last Name: {{ user.last_name }}</li>
          <li class="list-group mt-2">Username: {{ user.username }}</li>
          <li class="list-group mt-2">Email: {{ user.email}}</li>
        </ul>
        <hr class="line-break">
        <div id="buttons">
          <a href="{% url 'details_update' user.id %}" class="details-update">Update Details</a>
          <a href="{% url 'password_update' %}" class="details-update">Change Password</a>
        </div>
      </div>
    </section>
    {% if table_bookings.count > 0 %}
      <section>
        <div class="mt-5 ">
          <h2 id="bookings-heading">Your Bookings:</h2>
          <div id="booking-info">
            {% for table_booking in table_bookings %}
              {% if table_booking.day >= today %}
                <div class="bookings">
                  <p class="list-group mt-2">Day: {{ table_booking.day }}</p>
                  <p class="list-group mt-2">Time: {{ table_booking.time }}</p>
                  <p class="list-group mt-2">Table {{ table_booking.table }}</p>
                    {% if user.is_authenticated and table_booking.user == user %}
                      {% if table_booking.day > today %}
                      <hr>
                        <div class="mt-3 mb-2">
                          <div class="card-footer text-body-secondary">
                            <button aria-label="Open Edit Booking Modal" onclick="document.getElementById('edit').style.display='flex'" class="deletebtn">Edit Booking</button>
                            <div id="edit" class="modal">
                              <div class="edit">
                                <span class="close crud" title="Close Modal"><a aria-label="Close Edit Booking Modal" onclick="document.getElementById('edit').style.display='none'">Close X</a></span>
                                <form class="modal-content" action="/action_page.php">
                                  <div class="container">
                                    <h2>Edit Booking</h2>
                                    <p>Are you sure you want to make changes to your booking?</p>
                                    <div class="clearfix">
                                      <a aria-label="Close Edit Booking Modal" onclick="document.getElementById('edit').style.display='none'" class="cancelbtn btn btn-outline-primary btn-sm">Keep Booking</a>
                                      <a aria-label="Open Page for Update Booking Form" class="deletebtn btn btn-outline-danger btn-sm" href="{% url 'user_update' table_booking.id %}">Change Booking</a>
                                    </div>
                                  </div>
                                </form>
                              </div>
                            </div>
                          </div>
                          <div class="card-footer text-body-secondary">
                            <button aria-label="Open Cancel Booking Modal" onclick="document.getElementById('delete').style.display='flex'" class="deletebtn">Cancel Booking</button>
                            <div id="delete" class="modal">
                              <div class="delete">
                                <span class="close crud" title="Close Modal"><a aria-label="Close Cancel Booking Modal" onclick="document.getElementById('delete').style.display='none'">Close X</a></span>
                                <form class="modal-content" action="/action_page.php">
                                  <div class="container">
                                    <h2>Cancel Booking</h2>
                                    <p>Are you sure you want to cancel your table booking?</p>
                                    <div class="clearfix">
                                      <a aria-label="Close Cancel Booking Modal" onclick="document.getElementById('delete').style.display='none'" class="cancelbtn btn btn-outline-primary btn-sm">Keep Booking</a>
                                      <a aria-label="Click to Cancel Booking" href="{% url 'delete_booking' table_booking.id %}" class="deletebtn btn btn-outline-danger btn-sm">Cancel Booking</a>
                                    </div>
                                  </div>
                                </form>
                              </div>
                            </div>
                          </div>
                        </div>
                      {% else %}
                      <div class="card-footer text-body-secondary">
                        <p>If a last minute change to your booking is needed. Please contact us on: 02920111111</p>
                      </div>
                    </div>
                      {% endif %}
                    {% endif %}
                </div>
                <br><br>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </section>
    {% endif %}
  </main>
{% endblock %}